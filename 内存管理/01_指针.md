# 1.åŸºæœ¬æ¦‚å¿µ

å¯¹äºæŒ‡é’ˆï¼ŒæŒ‡é’ˆï¼ˆ`T*`ï¼‰æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå˜é‡ï¼Œ**é‡Œé¢å­˜æ”¾çš„æ˜¯å¦ä¸€å—å†…å­˜çš„åœ°å€**ï¼Œé‚£å—å†…å­˜é‡Œæ”¾ç€ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰`T` ç±»å‹å¯¹è±¡ã€‚åŒæ ·ï¼Œå®Œå…¨å¯ä»¥æŠŠæŒ‡é’ˆå½“æˆä¸€ä¸ª**æ•´å‹çš„æ•°æ®**ï¼ˆæ¯”å¦‚ï¼š`0x7ffd94cd9564`ï¼Œè¿™æ˜¯ä¸€ä¸ªæ•´å‹æ•°æ®ï¼Œä½†è¡¨ç¤ºçš„æ˜¯å†…å­˜å—çš„åœ°å€ï¼‰ã€‚

- **ä¸¤å¤§æ“ä½œç¬¦**
    
    - å–åœ°å€ï¼š`&obj` å¾—åˆ° `obj` çš„åœ°å€ï¼ˆç±»å‹æ˜¯ `T*`ï¼‰ã€‚
        
    - è§£å¼•ç”¨ï¼š`*p` è®¿é—®æŒ‡é’ˆ `p` æ‰€æŒ‡å‘çš„å¯¹è±¡æœ¬èº«ï¼ˆç±»å‹æ˜¯ `T&`ï¼‰ã€‚

```cpp
int x = 42;
int* p = &x;    // p é‡Œè£…çš„æ˜¯ x çš„åœ°å€
*p = 7;         // é€šè¿‡ p æ”¹ xï¼Œx å˜æˆ 7
```

å‡è®¾ `x` çš„åœ°å€æ˜¯ `0x10a3`ï¼Œé‚£ä¹ˆ `p` è¿™ä¸ªå˜é‡è£…çš„å†…å®¹å°±æ˜¯ `0x10a3`ï¼ˆå³æŒ‡å‘çš„å°±æ˜¯ä¸€å—å†…å­˜åœ°å€ï¼‰ï¼Œå½“ç”¨ `*p` æ—¶ï¼Œå®é™…ä¸Šå°±æ˜¯**å– `0x10a3` è¿™ä¸ªåœ°å€çš„å€¼**ã€‚

---

# 2.æŒ‡é’ˆ vs å¼•ç”¨

- **å¼•ç”¨**æ˜¯å·²æœ‰å¯¹è±¡çš„**åˆ«å**ï¼Œä¸èƒ½ä¸º `null`ï¼ˆè¯­ä¹‰ä¸Šï¼‰ï¼Œä¸€æ—¦ç»‘å®šå°±**ä¸å¯æ”¹æŒ‡å‘**ã€‚
    
- **æŒ‡é’ˆ**å¯ä»¥ä¸ºç©ºï¼ˆ`nullptr`ï¼‰ã€å¯ä»¥æŒ‡å‘ä¸åŒå¯¹è±¡ã€å¯ä»¥åšç®—æœ¯ï¼ˆæ•°ç»„åœºæ™¯ï¼‰ã€‚
    
- **æŒ‡é’ˆçš„å¼•ç”¨** = â€œ**æŒ‡é’ˆå˜é‡æœ¬èº«**çš„åˆ«åâ€ã€‚

```cpp
void f(int *&rp) {         // rp æ˜¯â€œæŒ‡å‘ int çš„æŒ‡é’ˆâ€çš„å¼•ç”¨
    static int y = 99;
    rp = &y;               // è¿™ä¼šä¿®æ”¹è°ƒç”¨æ–¹çš„æŒ‡é’ˆå˜é‡æœ¬èº«
}

int x = 1;
int* p = &x;
f(p);                      // p ç°åœ¨æŒ‡å‘ y äº†
```

---

# 3.å­˜å‚¨æœŸä¸æ‰€æœ‰æƒ

ç†è§£â€œå¯¹è±¡æ´»å¤šä¹…â€å’Œâ€œè°è´Ÿè´£é‡Šæ”¾â€æ˜¯ç”¨å¥½æŒ‡é’ˆçš„å…³é”®ã€‚

- **è‡ªåŠ¨å­˜å‚¨ï¼ˆæ ˆï¼‰**ï¼šå±€éƒ¨å˜é‡ï¼Œç¦»å¼€ä½œç”¨åŸŸè‡ªåŠ¨é”€æ¯ã€‚
    
- **é™æ€å­˜å‚¨**ï¼šç¨‹åºæœŸå†…ä¸€ç›´å­˜åœ¨ï¼ˆ`static`ã€å…¨å±€ï¼‰ã€‚
    
- **åŠ¨æ€å­˜å‚¨ï¼ˆå †ï¼‰**ï¼š`new` åˆ†é…ï¼Œ**ä½ è´Ÿè´£**ç”¨ `delete`ã€`delete[]` é‡Šæ”¾ã€‚

åˆ›å»ºä¸€ä¸ªæŒ‡é’ˆ rootï¼Œè®© root æŒ‡å‘å†…å­˜ä¸­å­˜æ”¾ 2 è¿™ä¸ªæ•°å­—çš„åœ°å€ï¼š

```cpp
TreeNode* root = new TreeNode(2); // åœ¨å †ä¸Š
```

åƒè¿™æ ·ï¼š

```
æ ˆ (stack)         å † (heap)
----------         -------------
root â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ [ TreeNode(2) ]
```

åˆ é™¤å†…å­˜ä¸­å­˜æ”¾ 2 è¿™ä¸ªæ•°å­—çš„åœ°å€çš„æ•°æ®ï¼š

```cpp
delete root;                      // é‡Šæ”¾å †å†…å­˜ï¼ˆroot å˜é‡æœ¬èº«è¿˜åœ¨ï¼‰
root = nullptr;                   // é˜²æ­¢æ‚¬ç©º
```

åƒè¿™æ ·ï¼š

```
æ ˆ (stack)         å † (heap)
----------         -------------
root â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ [   å·²é‡Šæ”¾   ]
```

> å…³é”®ç‚¹ï¼š`delete root;` **é‡Šæ”¾çš„æ˜¯ root æŒ‡å‘çš„å¯¹è±¡**ï¼ˆåœ¨è¿™é‡Œï¼Œroot æŒ‡å‘çš„å°±æ˜¯å­˜æ”¾ 2 è¿™ä¸ªæ•°çš„èŠ‚ç‚¹çš„åœ°å€ï¼‰ï¼Œä¸æ˜¯æŠŠ `root` è¿™ä¸ªå˜é‡â€œåˆ æ‰â€ã€‚`root` ä»ç„¶å­˜åœ¨ï¼Œä½†å˜æˆæ‚¬ç©ºæŒ‡é’ˆï¼Œæ‰€ä»¥è¦æŠŠå®ƒè®¾ä¸º `nullptr`ã€‚

ä¸€é¢—å°æ ‘çš„å†…å­˜ç¤ºæ„å›¾ğŸ˜€ï¼š

```cpp
// å†…å­˜å¸ƒå±€ç¤ºæ„å›¾ï¼ˆå‡è®¾åœ°å€ä»0x1000å¼€å§‹ï¼‰

// TreeNodeç»“æ„å®šä¹‰ï¼ˆå‡è®¾ï¼‰:
struct TreeNode {
    int val;
    TreeNode* left;
    TreeNode* right;
    TreeNode(int x) : val(x), left(nullptr), right(nullptr) {}
};

// åˆ›å»ºèŠ‚ç‚¹åçš„å†…å­˜çŠ¶æ€:
TreeNode* root = new TreeNode(8);    // åœ°å€: 0x1000
root->left = new TreeNode(4);        // åœ°å€: 0x2000  
root->right = new TreeNode(12);      // åœ°å€: 0x3000

/*
å†…å­˜å¸ƒå±€:

æ ˆå†…å­˜:
+-----------+----------+
| å˜é‡å    | å€¼       |
+-----------+----------+
| root      | 0x1000   |
+-----------+----------+

å †å†…å­˜:
åœ°å€ 0x1000 (root æŒ‡å‘çš„åœ°å€):
+----------+----------+----------+
| val: 8   | left:0x2000 | right:0x3000 |
+----------+----------+----------+

åœ°å€ 0x2000 (root->left æŒ‡å‘çš„åœ°å€):
+----------+----------+----------+
| val: 4   | left:nullptr | right:nullptr |
+----------+----------+----------+

åœ°å€ 0x3000 (root->right æŒ‡å‘çš„åœ°å€):
+----------+----------+----------+
| val: 12  | left:nullptr | right:nullptr |
+----------+----------+----------+
*/

// æ ‘å½¢ç»“æ„:
//       8
//      / \
//     4   12
```

---

# 4.å¸¸è§æŒ‡é’ˆçš„â€œå‘â€

- **æœªåˆå§‹åŒ–æŒ‡é’ˆï¼ˆé‡æŒ‡é’ˆï¼‰**ï¼š`int* p; *p = 1;` â€”â€” æœªå®šä¹‰è¡Œä¸ºã€‚
    
- **ç©ºæŒ‡é’ˆè§£å¼•ç”¨**ï¼š`int* p = nullptr; *p = 1;` â€”â€” æœªå®šä¹‰è¡Œä¸ºã€‚
    
- **æ‚¬ç©ºæŒ‡é’ˆï¼ˆuse-after-freeï¼‰**ï¼š`delete p; *p = 1;` â€”â€” æœªå®šä¹‰è¡Œä¸ºã€‚
    
- **åŒé‡é‡Šæ”¾**ï¼šåŒä¸€å—å†…å­˜ `delete` ä¸¤æ¬¡ â€”â€” æœªå®šä¹‰è¡Œä¸ºã€‚
    
- **æ•°ç»„é‡Šæ”¾æ–¹å¼é”™è¯¯**ï¼š`new[]` å¿…é¡» `delete[]`ï¼›å•å¯¹è±¡ `new` å¿…é¡» `delete`ã€‚
    
- **å¤šæ€åˆ é™¤æ²¡è™šææ„**ï¼šé€šè¿‡**åŸºç±»æŒ‡é’ˆ**åˆ é™¤æ´¾ç”Ÿå¯¹è±¡ï¼ŒåŸºç±»ææ„å¿…é¡» `virtual`ï¼Œå¦åˆ™æ´¾ç”Ÿææ„ä¸ä¼šè¢«è°ƒç”¨ï¼Œèµ„æºæ³„æ¼ã€‚

---

# 5.æŒ‡é’ˆçš„å…¶å®ƒè¦ç‚¹

## 5.1 const ä¸æŒ‡é’ˆç»„åˆ

- `const int* p`ï¼š**æŒ‡å‘å¸¸é‡çš„æŒ‡é’ˆ**ï¼ˆä¸èƒ½é€šè¿‡ `p` æ”¹æ‰€æŒ‡å¯¹è±¡ï¼›p è‡ªå·±èƒ½æ”¹æŒ‡å‘ï¼‰
    
- `int* const p`ï¼š**å¸¸é‡æŒ‡é’ˆ**ï¼ˆp ä¸èƒ½æ”¹æŒ‡å‘ï¼›ä½†èƒ½æ”¹æ‰€æŒ‡å¯¹è±¡ï¼‰
    
- `const int* const p`ï¼šä¸¤è€…éƒ½ä¸èƒ½æ”¹

```cpp
int a=1, b=2;
const int* p = &a;   // *p åªè¯»ï¼Œp å¯æ”¹
p = &b;              // OK

int* const q = &a;   // q ä¸å¯æ”¹æŒ‡å‘ï¼Œ*q å¯æ”¹
*q = 3;              // OK
```


## 5.2 æŒ‡é’ˆä¸æ•°ç»„

- æ•°ç»„ååœ¨å¤§å¤šæ•°è¡¨è¾¾å¼é‡Œä¼š**è¡°å˜**ä¸ºæŒ‡å‘é¦–å…ƒç´ çš„æŒ‡é’ˆï¼ˆ`T*`ï¼‰ã€‚
    
- æŒ‡é’ˆå¯ä»¥åš**æŒ‡é’ˆç®—æœ¯**ï¼š`p+1` æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ ï¼ˆæ­¥é•¿æŒ‰ `sizeof(T)`ï¼‰ã€‚
    
- `sizeof(arr)` ä¸ `sizeof(p)` ä¸åŒï¼šå‰è€…æ˜¯æ•°ç»„å¤§å°ï¼ˆå­—èŠ‚æ•°ï¼‰ï¼Œåè€…æ˜¯æŒ‡é’ˆå¤§å°ã€‚

```cpp
int arr[3] = {1,2,3};
int* p = arr;      // ç­‰ä»·äº &arr[0]
*(p+1) = 42;       // æ”¹ arr[1]
```

> æ³¨æ„ï¼š`std::vector` å¢é•¿ä¼šæ¬å®¶ï¼Œ**ä¿å­˜å®ƒå…ƒç´ çš„æŒ‡é’ˆ/å¼•ç”¨ä¼šå¤±æ•ˆ**ã€‚


## 5.3 å‡½æ•°å‚æ•°ä¼ é€’çš„å‡ ç§æ–¹å¼

- `T* p`ï¼šä¼ å…¥ä¸€ä¸ªåœ°å€çš„**æ‹·è´**ï¼›ä½ æ”¹ `p` çš„æŒ‡å‘ï¼Œ**è°ƒç”¨æ–¹çœ‹ä¸è§**ã€‚
    
- `T*& p`ï¼šä¼ å…¥â€œæŒ‡é’ˆæœ¬èº«çš„å¼•ç”¨â€ï¼›ä½ æ”¹ `p` çš„æŒ‡å‘ï¼Œ**è°ƒç”¨æ–¹åŒæ­¥æ”¹å˜**ï¼ˆBST åˆ é™¤ç”¨çš„å°±æ˜¯å®ƒï¼‰ã€‚
    
- `T& x`ï¼šä¼ å…¥å¯¹è±¡åˆ«åï¼›ä¸èƒ½ä¸º nullï¼Œä¸èƒ½æ”¹å¼•ç”¨çš„ç»‘å®šå¯¹è±¡ã€‚


## 5.4 å…¶ä»–æŒ‡é’ˆç±»å‹ï¼ˆçŸ¥é“å³å¯ï¼‰

- **`void*`**ï¼šæ— ç±»å‹æŒ‡é’ˆï¼Œåªèƒ½å­˜åœ°å€ï¼Œä¸èƒ½ç›´æ¥è§£å¼•ç”¨ï¼›éœ€è¦å¼ºè½¬å›åŸç±»å‹ã€‚
    
- **æˆå‘˜æŒ‡é’ˆ**ï¼š`int C::* pm;` / `int (C::*pf)(...)`ã€‚è°ƒç”¨è¯­æ³•ç‰¹æ®Šï¼š`(obj.*pf)()`ã€`(ptr->*pm)`ã€‚
    
- **æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆ**ï¼š`int (*fp)(int);`ï¼›ç°ä»£ C++ æ›´æ¨èç”¨ `auto`ã€`std::function`ã€lambdaã€‚
    
- **ç±»å‹è½¬æ¢**ï¼š
    
    - `static_cast`ï¼šç¼–è¯‘æœŸå®‰å…¨ã€å¸¸ç”¨ï¼›
        
    - `reinterpret_cast`ï¼šä½çº§åˆ«é‡è§£é‡Šï¼Œå±é™©ï¼›
        
    - `const_cast`ï¼šåŠ /å» constï¼›
        
    - `dynamic_cast`ï¼šå¤šæ€å‘ä¸‹è½¬å‹ï¼Œéœ€å¤šæ€åŸºç±»ï¼ˆæœ‰è™šå‡½æ•°ï¼‰ï¼Œå¤±è´¥è¿”å› `nullptr`ï¼ˆæŒ‡é’ˆåœºæ™¯ï¼‰ã€‚
        